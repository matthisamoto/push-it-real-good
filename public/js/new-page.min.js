function killpreloader(){$("#"+current_preview_string).css("width","0")}function add_container(){var a=container.clone().addClass("search-container");$(".search-results").prepend(a)}function create_audio(a,b){$("audio").each(function(a){$(this).remove()});var c=document.createElement("audio");c.src="http://api.soundcloud.com/tracks/"+b+"/stream?client_id=72325d0b84c6a7f4bbef4dd86c0a5309",c.load(),c.id="audio",c.autobuffer=!0,c.preload="auto",a.append(c),c.play()}function prepNonFlash(a,b){$("audio").each(function(a){$(this).empty()});var c=document.createElement("audio");c.src="http://api.soundcloud.com/tracks/"+a+"/stream?client_id=72325d0b84c6a7f4bbef4dd86c0a5309",c.load(),c.id="audio",c.autobuffer=!0,c.preload="auto",b.append(c),c.play()}function prepFlash(a){$(current_preview_string)&&killFlash();var b="10.0.0",c="playerProductInstall.swf",d={};d.streamURL="http://api.soundcloud.com/tracks/"+a+"/stream?client_id=72325d0b84c6a7f4bbef4dd86c0a5309";var e={};e.quality="best",e.wmode="transparent";var f={};current_preview_string="flashcontent_"+a,swfobject.embedSWF("/swf/preview.swf",current_preview_string,"35","35",b,c,d,e,f)}function killFlash(){var a=$("#"+current_preview_string),b=a.parent();a.remove(),b.prepend(clonable_div.clone().attr("id",current_preview_string))}function togglePlayButton(a,b){var c=b.parent().attr("id");a.hasClass("active")?a.hasClass("playing")?(stop_playing(),a.find(".pause-img").addClass("hidden"),a.find(".play-img").removeClass("hidden"),a.removeClass("playing")):(start_playing(c,b),a.find(".pause-img").removeClass("hidden"),a.find(".play-img").addClass("hidden"),a.addClass("playing")):($(".play").removeClass("active"),$(".pause-img").addClass("hidden"),$(".play-img").removeClass("hidden"),start_playing(c,b),a.addClass("active"),a.addClass("playing"),a.find(".pause-img").removeClass("hidden"),a.find(".play-img").addClass("hidden"))}function stop_playing(){if($("body").hasClass("iphone")){var a=document.getElementById("audio");a.pause()}else killFlash()}function resume_playing(){if($("body").hasClass("iphone")){var a=document.getElementById("audio");a.play()}}function start_playing(a,b){$("body").hasClass("iphone")?prepNonFlash(a,b):prepFlash(a)}function search_soundcloud(){results_count=0,$(".close-results").remove(),$(".search-tracks .division-inner .LV_validation_message")&&$(".search-tracks .division-inner .LV_validation_message").remove();var a=$("input#search").val();$.post("/search",{q:a,limit:10,offset:10*results_count,client_id:"72325d0b84c6a7f4bbef4dd86c0a5309",filter:"streamable"},function(a){if(!jQuery.isEmptyObject(a)){var b="";b+='<div class="search scroll-pane">\n',b+=a,b+="</div>\n",$(".search-results").empty().scrollTop(0).append(b),initSearchFunctionality("initial")}else $(".search-results").empty().scrollTop(0).append('<div class="nothing">No Tracks Found.</div>')},"html")}function moreResults(){results_count++;var a=$("input#search").val();$.post("/search",{q:a,limit:10,offset:10*results_count,client_id:"72325d0b84c6a7f4bbef4dd86c0a5309",filter:"streamable"},function(a){search_scroll.getContentPane().append(a),initSearchFunctionality("subsequent")},"html")}function initSearchFunctionality(a){$(".play").click(function(a){a.preventDefault(),togglePlayButton($(this),$(this).parent(),$(this).parent().attr("id"))}),$(".select-track").click(function(a){a.preventDefault(),killFlash(),$("#page_sound_url").val("http://api.soundcloud.com/tracks/"+$(this).parent().parent().parent().attr("id")+"/stream"),$("#page_track_name").val($(this).parent().parent().parent().find(".track-header .track-title a").text()),$("#page_track_url").val($(this).parent().parent().parent().find(".track-header .track-title a").attr("href")),$("#page_track_author").val($(this).parent().parent().find(".track_author").text()),$("#page_track_author_url").val($(this).parent().parent().find(".track_author").attr("href")),$(".track-name").empty().css("background-color","#fff").css("background-color","rgba(255,255,255,0.60)").css("border","dashed 1px #282625").css("padding","5px 0").append('<span class="added"><img src="/images/x.png" class="x-out"/>Added track:</span> '+$(this).parent().parent().parent().find("span.track-title").text()).find(".x-out").css("cursor","pointer").click(function(){$(".track-name").empty().css("background-color","transparent").css("border","none").css("padding","0"),$(".id-container").empty()}),toggleSections($(".button-header"))}),a=="initial"?($(".close-results").length==0&&$(".search-button").after('<a href="#" class="close-results button">Clear Results</a>'),$(".close-results").click(function(a){a.preventDefault(),$(".search-results").empty(),$(this).remove()}),search_scroll=$(".scroll-pane").jScrollPane({verticalDragMaxHeight:25,verticalDragMinHeight:25}).data("jsp"),$(".scroll-pane").bind("jsp-scroll-y",function(a,b,c,d){d&&(moreResults(),$(this).unbind("jsp-scroll-y"))})):(search_scroll.reinitialise(),$(".scroll-pane").bind("jsp-scroll-y",function(a,b,c,d){d&&(moreResults(),$(this).unbind("jsp-scroll-y"))}))}function retrieve_colors(){$.post("/retrieve_colors",{style:$("select#button_style_name option:selected").attr("value")},function(a){$(".choose-color").empty().append(a),preview_image(),$("input[type=radio]").change(function(){preview_image()})})}function preview_image(){$(".image-preview span.button-preview").empty().append('<image src="/images/'+$("#button_style_name option:selected").val().toLowerCase()+"_"+$("input[name=button_color]:checked").attr("value").toLowerCase()+'.png" height= "150" width="300" />'),$(".image-preview span.button-preview img").mousedown(function(a){$(".image-preview img").css("margin-left","-150px")}),$(".image-preview span.button-preview img").mouseup(function(a){$(".image-preview img").css("margin-left","0")}),$(".button-url").empty().append('<input type="hidden" name="page[button_url]" class="url" value="'+$("#button_style_name option:selected").val().toLowerCase()+"_"+$("input[name=button_color]:checked").attr("value").toLowerCase()+'" />')}function checkForConnection(){if(SC.isConnected()){$(".sc-username").fetchUserInfo();if(!$(".disconnect-soundcloud").exists()){var a=clonable_a.clone();a.attr("href","#").html('<img src="/images/disconnect-soundcloud.png" alt="Disconnect From SoundCloud" />').addClass("disconnect-soundcloud"),$(".sc-username").after(a),$(".disconnect-soundcloud").click(function(a){SC.disconnect(),window.location="http://pushitrealgood.com/page/new",a.preventDefault()})}receivedConnectionFromSoundCloud()}else{initUploadSection(),$(".sc-username").fetchUserInfo();if(!$(".connect-soundcloud").exists()){var b=clonable_a.clone();b.attr("href","#").html('<img src="/images/connect-soundcloud.png" alt="Connect With SoundCloud" />').addClass("connect-soundcloud"),$(".sc-username").after(b),$(".connect-soundcloud").click(function(a){a.preventDefault(),initUploadSection()})}}}function initUploadSection(){window.location="https://soundcloud.com/connect/?client_id=8415d419022eb58d9e2b49997ad6b1ba&redirect_uri=http://pushitrealgood.com/connect&response_type=token&scope=non-expiring&display=popup"}function getAccessToken(a){receivedConnectionFromSoundCloud()}function receivedConnectionFromSoundCloud(){$(".sc-username").fetchUserInfo();if(!$(".disconnect-soundcloud").exists()){var a=clonable_a.clone();a.attr("href","#").html('<img src="/images/disconnect-soundcloud.png" alt="Disconnect From SoundCloud" />').addClass("disconnect-soundcloud"),$(".sc-username").after(a),$(".disconnect-soundcloud").click(function(a){a.preventDefault()})}$(".connect-soundcloud").exists()&&$(".connect-soundcloud").remove(),recordNewTrack(),user_results_count=0,SC.get("/me/tracks",{limit:10,streamable:!0,sharing:"public",format:"json"},function(a){if(!jQuery.isEmptyObject(a)){var b="";b+='<div class="search user-scroll-pane">\n',b+=parseResults(a),b+="</div>\n",$(".upload-results").empty().scrollTop(0).append(b),initUserTracksFunctionaity("initial")}else $(".upload-results").empty().scrollTop(0).append('<div class="nothing">You do not have any tracks uploaded.</div>')})}function moreUserResults(){user_results_count++,SC.get("/me/tracks",{limit:10,offset:10*user_results_count,streamable:!0,sharing:"public"},function(a){html=parseResults(a),user_scroll.getContentPane().append(html),initUserTracksFunctionaity("subsequent")})}function parseResults(a){var b="";return $.each(a,function(a,c){var d=Math.floor(parseInt(c.duration)/1e3),e=Math.floor(d/60),f=d-e*60;f<10&&(f="0"+f),b+='<div class="track clearfix" id="'+c.id+'">'+"\n",b+='<p class="track-header"><span class="track-title"><a href="'+c.permalink_url+'" target="_blank">'+c.title+"</a></span></p>"+"\n";var g="";c["streamable"]==1&&c["sharing"]=="public"&&c["state"]=="finished"?g+='<a href="#" class="play left"><div id="flashcontent_'+c.id+'"></div><img src="/images/play.png" alt="Preview" title="Preview" class="play-img"/><img src="/images/stop.png" alt="Preview" title="Preview" class="pause-img hidden" /></a>'+"\n":g+='<img src="/images/not-available.png" alt="Not Available" title="Not Available" class="left" />\n',g+='<p class="duration left">'+e+":"+f+"</p>"+"\n",g+='<p class="from left"><span class="from-script">from</span> <a href="'+c.user.permalink_url+'" target="_blank" class="track_author">'+c.user.username+"</a></p>",c["streamable"]==1&&c["sharing"]=="public"?g+='<p class="left"><a href="#" class="button select-track left" alt="Use This Track In Your Page" title="Use This Track In Your Page">Use This</a></p>\n':c["status"]!="finished"?g+='<span class="left no-stream">Your track is not done transcoding please try again later.</span>':g+='<span class="left no-stream">This track is not streamable. <a href="#" class="tooltip" onClick="javascript:function(e){e.preventDefault();}">Why?<span>Either the track is not streamable via SoundCloud, or the track is private. We cannot stream private tracks.</span></a></span>',b+='<div class="preview-line clearfix">'+g+"</div>\n",c.genre&&(b+='<p class="genre clearfix"> Genre: '+c.genre+"</p>"+"\n"),b+="</div>\n"}),b}function initUserTracksFunctionaity(a){$(".play").click(function(a){a.preventDefault(),togglePlayButton($(this),$(this).parent(),$(this).parent().attr("id"))}),$(".select-track").click(function(a){a.preventDefault(),killFlash(),$("#page_sound_url").val("http://api.soundcloud.com/tracks/"+$(this).parent().parent().parent().attr("id")+"/stream"),$("#page_track_name").val($(this).parent().parent().parent().find(".track-header .track-title a").text()),$("#page_track_url").val($(this).parent().parent().parent().find(".track-header .track-title a").attr("href")),$("#page_track_author").val($(this).parent().parent().find(".track_author").text()),$("#page_track_author_url").val($(this).parent().parent().find(".track_author").attr("href")),$(".track-name").empty().css("background-color","#fff").css("background-color","rgba(255,255,255,0.60)").css("border","dashed 1px #282625").css("padding","5px 0").append('<span class="added"><img src="/images/x.png" class="x-out"/>Added track:</span> '+$(this).parent().parent().parent().find("span.track-title").text()).find(".x-out").css("cursor","pointer").click(function(){$(".track-name").empty().css("background-color","transparent").css("border","none").css("padding","0"),$(".id-container").empty()}),toggleSections($(".button-header"))}),a=="initial"?(user_scroll=$(".user-scroll-pane").jScrollPane({verticalDragMaxHeight:25,verticalDragMinHeight:25}).data("jsp"),$(".user-scroll-pane").bind("jsp-scroll-y",function(a,b,c,d){d&&(moreUserResults(),$(this).unbind("jsp-scroll-y"))})):(user_scroll.reinitialise(),$(".user-scroll-pane").bind("jsp-scroll-y",function(a,b,c,d){d&&(moreUserResults(),$(this).unbind("jsp-scroll-y"))}))}function uploadNewFile(){}function recordNewTrack(){$("#recorderUI").removeClass("hidden"),$("#recorderUI.reset #controlButton").live("click",function(a){updateTimer(0),SC.record({start:function(){setRecorderUIState("recording")},progress:function(a,b){updateTimer(a)}}),a.preventDefault()}),$("#recorderUI.recording #controlButton, #recorderUI.playing #controlButton").live("click",function(a){setRecorderUIState("recorded"),$(".name-your-upload").removeClass("hidden"),$(".name-your-upload input").click(function(a){$(this).val()=="Name Your Track"&&$(this).val("")}),$("#otherControls").removeClass("hidden"),$("#uploadStatus").empty().addClass("hidden"),SC.recordStop(),a.preventDefault()}),$("#recorderUI.recorded #controlButton").live("click",function(a){setRecorderUIState("playing"),SC.recordPlay({progress:function(a){},finished:function(){setRecorderUIState("recorded")}}),a.preventDefault()}),$("#reset").live("click",function(a){a.preventDefault(),reset_recorder()}),$("#upload").live("click",function(a){setRecorderUIState("uploading");var b=function(){$("#uploadStatus").html("Uploading...").removeClass("hidden"),$(".name-your-upload").addClass("hidden"),$("#otherControls").addClass("hidden");var a;if($(".upload-title").val()==""){var b=new Date,c=b.getMonth().toString()+"-"+b.getDate().toString()+"-"+b.getFullYear().toString()+" "+b.getHours().toString()+":"+b.getMinutes().toString();a="Push It Real Good Recording "+c}else a=$(".upload-title").val();SC.recordUpload({track:{title:a,sharing:"public"}},function(a){$(".upload-results").empty(),receivedConnectionFromSoundCloud(),reset_recorder()})};SC.isConnected()?b():SC.connect({connected:b}),a.preventDefault()})}function reset_recorder(){SC.recordStop(),setRecorderUIState("reset"),$(".name-your-upload").addClass("hidden"),$("#otherControls").addClass("hidden"),$("#uploadStatus").addClass("hidden").empty()}function updateTimer(a){$("#uploadStatus").html("Recording "+SC.Helper.millisecondsToHMS(a)).removeClass("hidden")}function setRecorderUIState(a){$("#recorderUI").attr("class",a+" clearfix")}function toggleSections(a){a.hasClass("active")||($(".search-tracks").height()>0?($(".search-tracks").animate({height:"0"},500),$(".choose-button").animate({height:button_height},500,function(){document.getElementById("page_title_url").focus()}),$(".button-header").css("background-image","url(/images/orange_tile.png)").addClass("active"),$(".sound-header").css("background-image","url(/images/gray_tile.png)").removeClass("active")):($(".search-tracks").animate({height:search_height},500),$(".choose-button").animate({height:"0"},500),$(".button-header").css("background-image","url(/images/gray_tile.png)").removeClass("active"),$(".sound-header").css("background-image","url(/images/orange_tile.png)").addClass("active")))}function getUrlVars(){var a={},b=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d});return a}function toggleSearchUpload(a){a.hasClass("active")||($(".search-section").hasClass("hidden")?($(".search-section").removeClass("hidden"),$(".upload-section").addClass("hidden"),$(".toggle-bar .slider").animate({marginLeft:"0"},250,function(){$(".search-section-button").addClass("active"),$(".upload-section-button").removeClass("active")})):($(".search-section").addClass("hidden"),$(".upload-section").removeClass("hidden"),$(".toggle-bar .slider").animate({marginLeft:"299"},250,function(){$(".search-section-button").removeClass("active"),$(".upload-section-button").addClass("active"),checkForConnection()})))}function check_url(){document.getElementById("create-new-button").disabled=!0;if($("#page_title_url").val())$.post("/test_url",{title_url:$("#page_title_url").val()},function(a){if(a.result=="fail"){$("#page_title_url").parent().find(".LV_validation_message")&&$("#page_title_url").parent().find(".LV_validation_message").remove();var b=clonable_div.clone().addClass("LV_validation_message").addClass("LV_invalid").text("This URL Is Unavailable");$("#page_title_url").addClass("LV_invalid_field").after(b)}else $("#page_title_url").parent().find(".LV_validation_message")&&$("#page_title_url").parent().find(".LV_validation_message").remove(),$("#page_title_url").hasClass("LV_invalid_field")&&$("#page_title_url").removeClass("LV_invalid_field"),document.getElementById("create-new-button").disabled=!1},"json");else{$("#page_title_url").parent().find(".LV_validation_message")&&$("#page_title_url").parent().find(".LV_validation_message").remove();var a=clonable_div.clone().addClass("LV_validation_message").addClass("LV_invalid").text("Cannot Be Empty");$("#page_title_url").addClass("LV_invalid_field").after(a)}}var current_preview_string,count=0,current_page=1,search_scroll,user_scroll,results_count=0,user_results_count=0,clonable_div=$("<div/>"),clonable_a=$("<a/>");$.fn.exists=function(){return this.length>0?!0:!1},$.fn.fetchUserInfo=function(){var a=this;return SC.isConnected()?SC.get("/me",function(b){a.text("Logged into SoundCloud as "+b.username)}):a.text("Not Logged Into SoundCloud"),this};var container=$("<div>"),csrf_token=$("meta[name=csrf-token]").attr("content");$("body").bind("ajaxSend",function(a,b,c){c.type=="POST"&&b.setRequestHeader("X-CSRF-Token",csrf_token)}),$("#page_tagline").keyup(function(){$(".title-preview").empty().text($(this).val()),$(".title-preview").text()==""&&$(".title-preview").append("My Title")}),$("select#button_style_name").selectBox(),retrieve_colors(),$("select#button_style_name").change(retrieve_colors),$(".search-button").click(function(a){a.preventDefault(),search_soundcloud()}),$("#search").keypress(function(a){a.which==13&&(a.preventDefault(),search_soundcloud())}),$("#search").click(function(a){$(this).val()=="Search SoundCloud for Tracks"&&$(this).val("")}),$(".next").each(function(){$(this).click(function(a){a.preventDefault(),moveScreen("forward"),$(".search-results").empty(),$(".close-results").remove()})}),$(".prev").each(function(){$(this).click(function(a){a.preventDefault(),moveScreen("backward")})}),$("body").hasClass("connect")&&(uri=new SC.URI(window.location.toString(),{decodeQuery:!0,decodeFragment:!0}),SC.accessToken(getUrlVars().access_token),toggleSearchUpload($(".upload-section-button")));var button_height=630,search_height=630;$(".search-section-button").click(function(a){toggleSearchUpload($(this))}),$(".upload-section-button").click(function(a){toggleSearchUpload($(this))}),$(".choose-button").css({height:"0"}),$(".button-header").click(function(a){toggleSections($(this))}),$(".sound-header").css("background-image","url(/images/orange_tile.png)").click(function(a){toggleSections($(this))});var titleValid=new LiveValidation("page_title_url",{validMessage:"✔",onlyOnSubmit:!0});titleValid.add(Validate.Format,{pattern:/^[A-Za-z0-9]*[A-Za-z0-9][A-Za-z0-9]*$/,failureMessage:"Letters and Numbers Only"}),titleValid.add(Validate.Presence,{failureMessage:"Letters and Numbers Only."}),$("#page_title_url").keyup(function(a){check_url()}),$("#page_title_url").change(function(a){check_url()}),$("#page_title_url").focus(function(a){check_url()}),$("#page_title_url").blur(function(a){check_url()}),$("input[type=submit]").click(function(a){if($(".id-container input.url").val()){if($("#page_title_url").hasClass("LV_invalid_field"))return!1}else{a.preventDefault();if($(".division-inner .LV_validation_message").length==0){var b=clonable_div.clone().addClass("LV_validation_message").addClass("LV_invalid").text("You Must Select A Track To Continue");$(".search-tracks .division-inner").prepend(b)}toggleSections()}})