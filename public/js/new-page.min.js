var current_preview_string,count,current_page,search_scroll,results_count,clonable_div,container,csrf_token,button_height,search_height,titleValid;function killpreloader(){$("#"+current_preview_string).css("width","0")}function add_container(){var a=container.clone().addClass("search-container");$(".search-results").prepend(a)}function create_audio(a,b){var c;$("audio").each(function(){$(this).remove()});c=document.createElement("audio");c.src="http://api.soundcloud.com/tracks/"+b+"/stream?client_id=72325d0b84c6a7f4bbef4dd86c0a5309",c.load(),c.id="audio",c.autobuffer=!0,c.preload="auto",a.append(c),c.play()}function prepNonFlash(a,b){var c;$("audio").each(function(){$(this).empty()});c=document.createElement("audio");c.src="http://api.soundcloud.com/tracks/"+a+"/stream?client_id=72325d0b84c6a7f4bbef4dd86c0a5309",c.load(),c.id="audio",c.autobuffer=!0,c.preload="auto",b.append(c),c.play()}function prepFlash(a){var b,c,d,e,f;$(current_preview_string)&&killFlash();b="10.0.0",c="playerProductInstall.swf",d={};d.streamURL="http://api.soundcloud.com/tracks/"+a+"/stream?client_id=72325d0b84c6a7f4bbef4dd86c0a5309";e={};e.quality="best",e.wmode="transparent";f={};current_preview_string="flashcontent_"+a,swfobject.embedSWF("/swf/preview.swf",current_preview_string,"35","35",b,c,d,e,f)}function killFlash(){var a=$("#"+current_preview_string),b=a.parent();a.remove(),b.prepend(clonable_div.clone().attr("id",current_preview_string))}function togglePlayButton(a,b){var c=b.parent().attr("id");a.hasClass("active")?a.hasClass("playing")?(stop_playing(),a.find(".pause-img").addClass("hidden"),a.find(".play-img").removeClass("hidden"),a.removeClass("playing")):(start_playing(c,b),a.find(".pause-img").removeClass("hidden"),a.find(".play-img").addClass("hidden"),a.addClass("playing")):($(".play").removeClass("active"),$(".pause-img").addClass("hidden"),$(".play-img").removeClass("hidden"),start_playing(c,b),a.addClass("active"),a.addClass("playing"),a.find(".pause-img").removeClass("hidden"),a.find(".play-img").addClass("hidden"))}function stop_playing(){var a;if($("body").hasClass("iphone")){a=document.getElementById("audio");a.pause()}else killFlash()}function resume_playing(){var a;if($("body").hasClass("iphone")){a=document.getElementById("audio");a.play()}}function start_playing(a,b){$("body").hasClass("iphone")?prepNonFlash(a,b):prepFlash(a)}function search_soundcloud(){var a;results_count=0,$(".close-results").remove(),$(".search-tracks .division-inner .LV_validation_message")&&$(".search-tracks .division-inner .LV_validation_message").remove();a=$("input#search").val();$.post("/search",{q:a,limit:10,offset:10*results_count,client_id:"72325d0b84c6a7f4bbef4dd86c0a5309",filter:"streamable"},function(a){var b="";b+='<div class="search scroll-pane">\n',b+=a,b+="</div>\n",$(".search-results").empty().scrollTop(0).append(b),initSearchFunctionality("initial")},"html")}function moreResults(){var a;results_count++;a=$("input#search").val();$.post("/search",{q:a,limit:10,offset:10*results_count,client_id:"72325d0b84c6a7f4bbef4dd86c0a5309",filter:"streamable"},function(a){search_scroll.getContentPane().append(a),initSearchFunctionality("subsequent")},"html")}function initSearchFunctionality(a){$(".play").click(function(a){a.preventDefault(),togglePlayButton($(this),$(this).parent(),$(this).parent().attr("id"))}),$(".select-track").click(function(a){a.preventDefault(),killFlash(),$("#page_sound_url").val("http://api.soundcloud.com/tracks/"+$(this).parent().parent().parent().attr("id")+"/stream"),$("#page_track_name").val($(this).parent().parent().parent().find(".track-header .track-title a").text()),$("#page_track_url").val($(this).parent().parent().parent().find(".track-header .track-title a").attr("href")),$("#page_track_author").val($(this).parent().parent().find(".track_author").text()),$("#page_track_author_url").val($(this).parent().parent().find(".track_author").attr("href")),$(".track-name").empty().css("background-color","#888").css("background-color","rgba(0, 132, 0, 0.60)").css("padding","5px 0").css("cursor","pointer").append('<span class="added">Added track:</span> '+$(this).parent().parent().parent().find("span.track-title").text()).click(function(){$(".track-name").empty().css("background-color","transparent").css("padding","0"),$(".id-container").empty()}),toggleSections()}),a=="initial"?($(".close-results").length==0&&$(".search-button").after('<a href="#" class="close-results button">Clear Results</a>'),$(".close-results").click(function(a){a.preventDefault(),$(".search-results").empty(),$(".search-results").append('\t<div class="upload-coming-soon"></div>'),$(this).remove()}),search_scroll=$(".scroll-pane").jScrollPane({verticalDragMaxHeight:25,verticalDragMinHeight:25}).data("jsp"),$(".scroll-pane").bind("jsp-scroll-y",function(a,b,c,d){d&&(moreResults(),$(this).unbind("jsp-scroll-y"))})):(search_scroll.reinitialise(),$(".scroll-pane").bind("jsp-scroll-y",function(a,b,c,d){d&&(moreResults(),$(this).unbind("jsp-scroll-y"))}))}function retrieve_colors(){$.post("/retrieve_colors",{style:$("select#button_style_name option:selected").attr("value")},function(a){$(".choose-color").empty().append(a),preview_image(),$("input[type=radio]").change(function(){preview_image()})})}function preview_image(){$(".image-preview span.button-preview").empty().append('<image src="/images/'+$("#button_style_name option:selected").val().toLowerCase()+"_"+$("input[name=button_color]:checked").attr("value").toLowerCase()+'.png" height= "150" width="300" />'),$(".image-preview span.button-preview img").mousedown(function(){$(".image-preview img").css("margin-left","-150px")}),$(".image-preview span.button-preview img").mouseup(function(){$(".image-preview img").css("margin-left","0")}),$(".button-url").empty().append('<input type="hidden" name="page[button_url]" class="url" value="'+$("#button_style_name option:selected").val().toLowerCase()+"_"+$("input[name=button_color]:checked").attr("value").toLowerCase()+'" />')}function toggleSections(){$(".search-tracks").height()>0?($(".search-tracks").animate({height:"0"},500),$(".choose-button").animate({height:button_height},500,function(){document.getElementById("page_title_url").focus()}),$(".button-header").css("background-image","url(/images/orange_tile.png)"),$(".sound-header").css("background-image","url(/images/gray_tile.png)")):($(".search-tracks").animate({height:search_height},500),$(".choose-button").animate({height:"0"},500),$(".button-header").css("background-image","url(/images/gray_tile.png)"),$(".sound-header").css("background-image","url(/images/orange_tile.png)"))}function check_url(){var a;document.getElementById("create-new-button").disabled=!0;if($("#page_title_url").val())$.post("/test_url",{title_url:$("#page_title_url").val()},function(a){var b;if(a.result=="fail"){$("#page_title_url").parent().find(".LV_validation_message")&&$("#page_title_url").parent().find(".LV_validation_message").remove();b=clonable_div.clone().addClass("LV_validation_message").addClass("LV_invalid").text("This URL Is Unavailable");$("#page_title_url").addClass("LV_invalid_field").after(b)}else $("#page_title_url").parent().find(".LV_validation_message")&&$("#page_title_url").parent().find(".LV_validation_message").remove(),$("#page_title_url").hasClass("LV_invalid_field")&&$("#page_title_url").removeClass("LV_invalid_field"),document.getElementById("create-new-button").disabled=!1},"json");else{$("#page_title_url").parent().find(".LV_validation_message")&&$("#page_title_url").parent().find(".LV_validation_message").remove();a=clonable_div.clone().addClass("LV_validation_message").addClass("LV_invalid").text("Cannot Be Empty");$("#page_title_url").addClass("LV_invalid_field").after(a)}}count=0,current_page=1,results_count=0,clonable_div=$("<div/>"),container=$("<div>"),csrf_token=$("meta[name=csrf-token]").attr("content");$("body").bind("ajaxSend",function(a,b,c){c.type=="POST"&&b.setRequestHeader("X-CSRF-Token",csrf_token)}),$("#page_tagline").keyup(function(){$(".title-preview").empty().text($(this).val()),$(".title-preview").text()==""&&$(".title-preview").append("My Title")}),$("select#button_style_name").selectBox(),retrieve_colors(),$("select#button_style_name").change(retrieve_colors),$(".search-button").click(function(a){a.preventDefault(),search_soundcloud()}),$("#search").keypress(function(a){a.which==13&&(a.preventDefault(),search_soundcloud())}),$("#search").click(function(){$(this).val()=="Search SoundCloud for Tracks"&&$(this).val("")}),$(".next").each(function(){$(this).click(function(a){a.preventDefault(),moveScreen("forward"),$(".search-results").empty(),$(".close-results").remove()})}),$(".prev").each(function(){$(this).click(function(a){a.preventDefault(),moveScreen("backward")})});button_height=630,search_height=630;$(".choose-button").css({height:"0"}),$(".button-header").click(function(){toggleSections()}),$(".sound-header").css("background-image","url(/images/orange_tile.png)").click(function(){toggleSections()});titleValid=new LiveValidation("page_title_url",{validMessage:"âœ”",onlyOnSubmit:!0});titleValid.add(Validate.Format,{pattern:/^[A-Za-z0-9]*[A-Za-z0-9][A-Za-z0-9]*$/,failureMessage:"Letters and Numbers Only"}),titleValid.add(Validate.Presence,{failureMessage:"Letters and Numbers Only."}),$("#page_title_url").keyup(function(){check_url()}),$("#page_title_url").change(function(){check_url()}),$("#page_title_url").focus(function(){check_url()}),$("#page_title_url").blur(function(){check_url()}),$("input[type=submit]").click(function(a){var b;if($(".id-container input.url").val()){if($("#page_title_url").hasClass("LV_invalid_field"))return!1}else{a.preventDefault();if($(".division-inner .LV_validation_message").length==0){b=clonable_div.clone().addClass("LV_validation_message").addClass("LV_invalid").text("You Must Select A Track To Continue");$(".search-tracks .division-inner").prepend(b)}toggleSections()}})